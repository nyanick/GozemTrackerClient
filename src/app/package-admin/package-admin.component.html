<!-- <div class="pl-5 pt-3">
  <h4 class="font-weight-bold">Packages</h4>
</div>
<div id="contenu" class="rounded shadow-sm">
  <hr class="divider">
  <aside class="px-5 pt-3">
    <h5 class="font-weight-bold">Liste of Packages</h5>
    <h6>Below you would list the list of all the created packages, you can create, edit of delete.</h6>
  </aside>
  <article class="px-5 pt-3 responsive">
    <div class="row">
      <div class="col-md-6">
      </div>
      <div class="col-md-2">
        <button type="button" class="btn btn-round but" style="float: right">
          <span class="fa fa-plus-circle form-control-feedback"></span> Create
        </button>
      </div>
      <div class="col-md-4">
        <div class="form-group has-search">
          <span class="fa fa-search form-control-feedback"></span>
          <input type="text" class="form-control" placeholder="Package ID">
        </div>
      </div>
    </div>
    <div class="table-responsive">
      <table class="table align-items-center table-flush">
        <thead class="thead-light">
        <tr style="color: #ffaf07;">
          <th style="width: 1%;"></th>
          <th style="width: 15%;">Package ID</th>
          <th style="width: 20%;">Description</th>
          <th style="width: 10%;">Weight</th>
          <th style="width: 15%;">Width</th>
          <th style="width: 10%;">Height</th>
          <th style="width: 15%;">depth</th>
          <th style="width: 10%;">Sender Name</th>
          <th style="width: 15%;">Sender Address</th>
          <th style="width: 10%;">Receiver Name</th>
          <th style="width: 10%;">Receiver Address</th>
          <th style="width: 10%;">Sender Latitude</th>
          <th style="width: 10%;">Sender Longitude</th>
          <th style="width: 10%;">Receiver Latitude</th>
          <th style="width: 10%;">Receiver Longitude</th>
          <th style="width: 2%;"></th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let data of result let i=index" [attr.data.index]="i">
          <th scope="row">{{i+1}}</th>
          <td>{{data.package_id}}</td>
          <td>{{data.description}}</td>
          <td>{{data.weight}}</td>
          <td>{{data.width}}</td>
          <td>{{data.height}}</td>
          <td>{{data.depth}}</td>
          <td>{{data.from_name}}</td>
          <td>{{data.from_address}}</td>
          <td>{{data.to_name}}</td>
          <td>{{data.to_address}}</td>
          <td>{{data.from_location.lat}</td>
          <td>{{data.from_location.lng}}</td>
          <td>{{data.to_location.lat}</td>
          <td>{{data.to_location.lng}}</td>

          <td class="text-right">
            <div class="dropup">
              <a style="vertical-align: center" class="btn btn-sm btn-icon-only dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="fa fa-ellipsis-h"></i>
              </a>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a style="cursor: pointer" class="dropdown-item">DÃ©tails</a>
                <a style="cursor: pointer" class="dropdown-item">Edit</a>
                <a style="cursor: pointer" class="dropdown-item" (click)="deletePackage(data._id)">Supprimer</a>
              </div>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </article>
</div> -->


<div class="my-4 mx-auto box">
        
  <div class="my-5 float-right">

      <button class="btn float-right btn-info btn-block" (click)="open(packageModal)">Create Package</button>
      <button class="btn mt-20 float-right btn-warning btn-block" (click)="open(deliveryModal)">Create Delivery</button>

  </div>
  <div class="ml-md-4 my-3 float-left">
      <div class="col">
          <label >Package List</label>
          <div class="row-cols-1 box-2">
            <div id="table_size" class="table-responsive" style="max-width: 100%;">
              <table class="table table-striped table-hover table-sm align-middle table-bordered text-center">
                <thead class="table-dark">
                  <tr>
                    <th scope="col-4">ID</th>
                    <th scope="col-8">Description</th>
                    <th scope="col-8">Active Delivery ID</th>
                    <th scope="col-8">Package Weight</th>
                    <th scope="col-8">Package Width</th>
                    <th scope="col-8">Package Height</th>
                    <th scope="col-8">Package Depth</th>
                    <th scope="col-8">Sender Name</th>
                    <th scope="col-8">Reciever name</th>
                    <th scope="col-8">Sender Address</th>
                    <th scope="col-8">Reciever Address</th>
                    <th scope="col-8">Sender Latitude</th>
                    <th scope="col-8">Sender Longitude</th>
                    <th scope="col-8">Receiver Latitude</th>
                    <th scope="col-8">Receiver Longitude</th>
                    <th scope="col-4">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let package of packages | paginate: { itemsPerPage: 10, currentPage: p }">
                    <td>{{ package.package_id }}</td>
                    <td>{{ package.description }}</td>
                    <td>{{ package.active_delivery_id }}</td>
                    <td>{{ package.weight }}</td>
                    <td>{{ package.width }}</td>
                    <td>{{ package.height }}</td>
                    <td>{{ package.depth }}</td>
                    <td>{{ package.from_name }}</td>
                    <td>{{ package.to_name }}</td>
                    <td>{{ package.from_address }}</td>
                    <td>{{ package.to_address }}</td>
                    <td>{{ package.from_location.lat }}</td>
                    <td>{{ package.from_location.lng }}</td>
                    <td>{{ package.to_location.lat }}</td>
                    <td>{{ package.to_location.lng }}</td>
                    <td class="">
                      <div class="d-flex gap-2 justify-content-center">
                        <button class="btn btn-primary btn-sm" title="Edit Package" data-bs-toggle="modal" data-bs-target="#packageModal" (click) = "onEdit(package._id)">
                          Edit
                        </button>
                        
                        <button class="btn btn-danger btn-sm" title="Delete Package" (click) = "DeletePackage(package._id)">
                          delete
                        </button>
                      </div>
                    </td>
                    
                  </tr>
                </tbody>
              </table>
              <pagination-controls *ngIf="packages.length > 10" (pageChange)="p = $event" class="text-center"></pagination-controls>
            </div>
          </div>
          <label class="mt-4" >Delivery List</label>
          <div class="row-cols-3 box-2">
            <div id="table_delivery" class="table-responsive" style="max-width: 100%;">
              <table class="table table-striped table-hover table-sm align-middle table-bordered text-center">
                <thead class="table-dark">
                  <tr>
                    <th scope="col-8">Delivery ID</th>
                    <th scope="col-8">Package ID</th>
                    <th scope="col-8">PickUp Time</th>
                    <th scope="col-8">Start Time</th>
                    <th scope="col-8">End Time</th>
                    <th scope="col-8">Location Lat</th>
                    <th scope="col-8">Location Long</th>
                    <th scope="col-8">Status</th>
                    <th scope="col-8">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let delivery of deliveries | paginate: { itemsPerPage: 10, currentPage: p }">
                    <td>{{ delivery.delivery_id }}</td>
                    <td>{{ delivery.package_id }}</td>
                    <td>{{ delivery.pickup_time }}</td>
                    <td>{{ delivery.start_time }}</td>
                    <td>{{ delivery.end_time }}</td>
                    <td>{{ delivery.location.lat }}</td>
                    <td>{{ delivery.location.lng }}</td>
                    <td>{{ delivery.status }}</td>
                    <td class="">
                      <div class="d-flex gap-2 justify-content-center">
                        <button class="btn btn-primary btn-sm" title="Edit Delivery" data-bs-toggle="modal" data-bs-target="#deliveryModal" (click) = "onEditDelivery(delivery._id)">
                          Edit
                        </button>
                        
                        
                        <button class="btn btn-danger btn-sm" title="Delete Client">
                          delete
                        </button>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
              <pagination-controls *ngIf="deliveries.length > 10" (pageChange)="p = $event" class="text-center"></pagination-controls>
            </div>
          </div>
      </div>
  </div>
</div>


 <!-- Package Modal -->
 <ng-template #packageModal tabindex="-1" let-d="dismiss" let-c="close"  aria-hidden="false">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="PackageModalLabel">Package Details</h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="d('Cross click')">X</button>
      </div>
      <div class="modal-body">
        <form [formGroup] = "packageForm" class="d-flex gap-3">
          <div>
            <div class="mb-3">
              <label for="description" class="form-label">Description</label>
              <input type="text" class="form-control" id="description" formControlName="description">
            </div>

            <div class="mb-3">
              <label for="weight" class="form-label">Weight</label>
              <input type="text" class="form-control" id="weight" formControlName="weight">
            </div>

            <div class="mb-3">
              <label for="width" class="form-label">Width</label>
              <input type="text" class="form-control" id="width" formControlName="width">
            </div>

            <div class="mb-3">
              <label for="height" class="form-label">Height</label>
              <input type="text" class="form-control" id="height" formControlName="height">
            </div>

          

            <div class="mb-3">
              <label for="depth" class="form-label">Depth</label>
              <input type="text" class="form-control" id="depth" formControlName="depth">
            </div>

            <div class="mb-3">
              <label for="to_location_lat" class="form-label">Destination Location(lat)</label>
              <input type="text" class="form-control" id="to_location_lat" formControlName="to_location_lat">
            </div>
            <div class="mb-3">
              <label for="to_location_long" class="form-label">Destination Location(long)</label>
              <input type="text" class="form-control" id="to_location_long" formControlName="to_location_long">
            </div>
          </div>

          <div>
            <div class="mb-3 ml-3">
              <label for="from_name" class="form-label">Source Name</label>
              <input type="text" class="form-control" id="from_name" formControlName="from_name">
            </div>

            <div class="mb-3 ml-3">
              <label for="from_address" class="form-label">Source Address</label>
              <input type="text" class="form-control" id="from_address" formControlName="from_address">
            </div>

            <div class="mb-3 ml-3">
              <label for="from_location_lat" class="form-label">Source Location(lat)</label>
              <input type="text" class="form-control" id="from_location_lat" formControlName="from_location_lat">
            </div>
            <div class="mb-3 ml-3">
              <label for="from_location_long" class="form-label">Source Location(long)</label>
              <input type="text" class="form-control" id="from_location_long" formControlName="from_location_long">
            </div>

            <div class="mb-3 ml-3">
              <label for="to_name" class="form-label">Destination Name</label>
              <input type="text" class="form-control" id="to_name" formControlName="to_name">
            </div>

            <div class="mb-3 ml-3">
              <label for="to_address" class="form-label">Destination Address</label>
              <input type="text" class="form-control" id="to_address" formControlName="to_address">
            </div>

            
          </div>
        </form>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="closeBtn" (click)="c('Close click')">Close</button>
        
        <button type="button" class="btn btn-primary" (click)="CreatePackage()" *ngIf="action == 'add'">Create</button>
        <button type="button" class="btn btn-primary" (click)="EditPackage()" *ngIf="action == 'edit'">Save changes</button>
      </div>
    </div>
  </div>
</ng-template>


<!-- Delivery Modal -->
<ng-template #deliveryModal tabindex="-1" let-d="dismiss" let-c="close"  aria-hidden="false">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="DeliveryModalLabel">Delivery Details</h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="d('Cross click')">X</button>
      </div>
      <div class="modal-body">
        <form [formGroup] = "deliveryForm" class="d-flex gap-3">
          <div>

            <div class="mb-3">
              <label for="package_id" class="form-label">Package Id</label>
              <select class="form-control" id="package_id" formControlName="package_id">
                <option *ngFor="let option of packages" [value]="option.package_id">
                  {{option.package_id}}
                </option>
              </select>
            </div>

            <div class="mb-3">
              <label for="pickup_time" class="form-label">Pickup Time</label>
              <input type="datetime" class="form-control" id="pickup_time" formControlName="pickup_time" readonly>
            </div>

            <div class="mb-3">
              <label for="start_time" class="form-label">Start Time</label>
              <input type="datetime" class="form-control" id="start_time" formControlName="start_time" readonly>
            </div>

            <div class="mb-3">
              <label for="status" class="form-label">Status</label>
              <select class="form-control" id="status" formControlName="status">
                <option *ngFor="let option of Status" [value]="option">
                  {{option}}
                </option>
              </select>
            </div>

            <!-- <div class="mb-3">
              <label for="status" class="form-label">Status</label>
              <input type="text" class="form-control" id="status" formControlName="status" readonly>
            </div> -->


          </div>

          <div>
            <div class="mb-3 ml-3">
              <label for="end_time" class="form-label">End Time</label>
              <input type="datetime" class="form-control" id="end_time" formControlName="end_time" readonly>
            </div>

            <div class="mb-3 ml-3">
              <label for="location_lat" class="form-label">Location Lat</label>
              <input type="text" class="form-control" id="location_lat" formControlName="location_lat">
            </div>

            <div class="mb-3 ml-3">
              <label for="location_long" class="form-label">Location Long</label>
              <input type="text" class="form-control" id="location_long" formControlName="location_long">
            </div>

          </div>
        </form>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="closeBtn" (click)="c('Close click')">Close</button>
        <button type="button" class="btn btn-primary" class="btn btn-primary" (click)="CreateDelivery()" *ngIf="action == 'add'" >Create</button>
        <button type="button" class="btn btn-primary" (click)="EditDelivery()" *ngIf="action == 'edit'">Save changes</button>
      </div>
    </div>
  </div>
</ng-template>


